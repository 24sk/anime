# 生成中画面（広告・待機演出）

離脱を防ぎつつ、広告を確実に閲覧してもらうための画面。

> 📸 **参考画像**: [生成中画面イメージ](/images/create.png)

[← 画面一覧に戻る](../ui-features.md)

---

## 実装タスク一覧（生成中画面）

- [ ] **プログレスバーの実装**
  - `UProgress` を使用。0から100%までのシミュレーションアニメーション作成
  - AIの処理進捗を示すアニメーションゲージ
- [ ] **ステータスメッセージのランダム表示**
  - `setInterval` を用いたテキストの切り替えロジック実装
  - 「毛並みを整えています...」「魔法をかけています...」といったランダムなステータスメッセージ表示
- [ ] **広告エリアの構築**
  - `UCard` を使用した中央広告枠のプレースホルダー作成
  - 画面中央の最も目立つ位置に配置
- [ ] **待機時間タイマーの実装**
  - 指定時間（10秒等）が経過するまで「次へ」ボタンを非表示、または自動遷移するロジックの実装
  - 生成が完了しても、最低待機時間が経過するまで次の画面へ進ませない制御
- [x] **生成失敗時のエラー表示**
  - Realtime でジョブが `failed` になったときに `UAlert` でユーザー向けメッセージを表示
  - 「もう一度やり直す」ボタンでストアをリセットしトップへ戻る

## 実装詳細

- [x] **プログレス表示**
  - AIの処理進捗を示すアニメーションゲージ（0%〜100%）
  - 「毛並みを整えています...」「魔法をかけています...」といったランダムなステータスメッセージ表示
  - 使用コンポーネント: `UProgress`、`UText` (ステータスメッセージ)
- [x] **メイン広告エリア（重要）**
  - 画面中央の最も目立つ位置に配置された広告枠
  - 生成が完了しても、最低待機時間（例：10秒）が経過するまで次の画面へ進ませない制御
  - 使用コンポーネント: `UCard`、`UContainer`
- [x] **ローディング演出**
  - ペットの足跡が歩き回るような可愛いアニメーション（ブランドイメージの定着）
  - 使用コンポーネント: CSS アニメーション + `UIcon` (足跡アイコン)
- [x] **生成失敗時のエラー表示**
  - ジョブが失敗（API エラー・クォータ超過など）した場合、`UAlert` で「生成に失敗しました」とバックエンドのユーザー向けメッセージを表示
  - 「もう一度やり直す」ボタンでストアをリセットしトップ画面へ遷移

## 開発時の表示確認（プレビュー）

生成中画面の**表示のみ**を確認したい場合（API・Realtime を動かさずに UI を確認する場合）は、開発サーバー起動中に次の URL でアクセスする。

- **生成中表示**: `/generating?preview=1`
  - プログレスバー・ステータスメッセージ・広告エリア・足跡アニメーションが表示される
  - Realtime 購読・ジョブ状態のポーリングは行わない（表示専用）
- **エラー表示**: `/generating?preview=1&error=1`
  - エラーメッセージと「もう一度やり直す」ボタンの表示を確認できる

※ `preview=1` は **開発時（`import.meta.dev` が true のとき）のみ**有効。本番ビルドでは無視され、通常どおり jobId が無いとトップへリダイレクトされる。
