# 要件定義書：AIペットアイコンジェネレーター「AniMe」

## 1. サービス概要

ユーザーがアップロードしたペット（犬・猫等）の写真を、Googleの最新AI「Gemini (Imagen 3)」を利用しておしゃれなイラスト風アイコンに変換するWebサービス。

* **サービス名:** AniMe（アニミー）
* **コンセプト:** 「うちの子」を世界に一つだけのデジタルアートへ。

## 2. ターゲットペルソナ

* **属性:** 30代を中心とした、SNS（Instagram/X）でペット専用アカウントを持つ飼い主。
* **ニーズ:** 自作はできないが、プロが描いたような高品質で可愛いアイコンを、自分のペットの特徴（毛色・種類）を残したまま手軽に作りたい。

## 3. 主要機能要件

### ① アイコン生成機能

* **生成モデル:** Gemini API (Imagen 3系) を採用。
* **生成プロセス:** Image-to-Image（写真をベースにした変換）。
* **スタイルプリセット:** 3Dアニメ風、水彩画風、手書きゆるふわ風、サイバーパンク風、韓国風、シンプルイラスト。

### ② 広告・待機管理機能（必須要件）

* **強制広告表示:** 生成中（API処理待ち時間）に画面中央へ広告を配置。
* **ダウンロード制限:** 広告視聴（一定時間経過）をフロントエンドおよびバックエンドで検証後、保存ボタンを活性化。

### ③ 画像書き出し・共有

* **フォーマット:** 正方形（1:1）。
* **プレビュー:** SNSアイコン枠（円形）での表示シミュレーター。

## 4. 技術スタック

| レイヤー | 選定技術 | 備考 |
| :--- | :--- | :--- |
| **フロントエンド** | **Nuxt 4** | 最新のVueフレームワークによる高速UX |
| **BaaS (DB)** | **Supabase** | PostgreSQLによるジョブ管理・リアルタイムステータス更新 |
| **バックエンド** | **Nitro (Nuxt 4)** | Gemini APIとの通信、署名付きURLの発行、ロジック管理 |
| **画像生成API** | **Gemini (Imagen 3)** | 日本語プロンプト理解に優れた高精度生成 |
| **ストレージ** | **Vercel Blob** | 生成画像の一時保存・エッジ配信 |
| **インフラ** | **Vercel** | フロントエンドおよびサーバーレス関数のホスティング |

## 5. データ設計（非認証・Supabase活用モデル）

認証なしでも匿名性を維持しつつ、Supabaseを活用して以下のデータを管理する。

* **Generation Jobs:** * ID, セッションID, ステータス(pending/completed), スタイル, 画像URL, 広告視聴フラグ。
    * SupabaseのRealtime機能で生成完了をフロントエンドに通知。
* **Rate Limits:** * IPアドレス単位でのリクエスト制限。
* **Blob Storage:** * 生成画像は Vercel Blob に保存。DBにはその参照URLを格納。

## 6. 画面構成案

1.  **トップ画面:** スタイル選択、画像アップロード、生成開始ボタン。
2.  **生成中画面:** **【広告表示エリア】**、AI処理ステータス、プログレスバー。
3.  **完了画面:** アイコンプレビュー、ダウンロードボタン、SNSシェア。

## 7. 将来的な拡張性

* 有料プラン（広告非表示、高画質、バリエーション一括生成）。
* Supabase Auth を利用したマイページ機能（過去作品の永続保存）。
* オリジナルグッズ連携。
